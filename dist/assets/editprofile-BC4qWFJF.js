import{t as M,u as S,A as D}from"./navbar-B4jypeQx.js";import{s as T,a as $,f as K}from"./logout-SE-Pe0Xt.js";document.addEventListener("DOMContentLoaded",function(){M(),S(),T(),$(),K()});const s=document.getElementById("profileContainer"),N=localStorage.getItem("accessToken"),A=localStorage.getItem("userName");if(!N||!A){const e=document.createElement("p");e.textContent="You must be logged in to edit your profile.",e.className="text-red-500 text-center",s.appendChild(e)}else fetch(`https://v2.api.noroff.dev/auction/profiles/${A}`,{headers:{Authorization:`Bearer ${N}`,"X-Noroff-API-Key":D}}).then(e=>e.json()).then(e=>{const{name:d,email:I,avatar:l,banner:i,bio:F}=e.data;s.innerHTML="";const g=document.createElement("h1");g.textContent="Edit Profile",g.className="text-2xl font-bold text-center mb-6",s.appendChild(g);const o=document.createElement("p");o.id="formError",o.className="text-red-500 text-sm hidden text-center mb-4",s.appendChild(o);const t=document.createElement("form");t.className="space-y-4 max-w-lg mx-auto bg-gray-800 p-6 rounded-lg shadow-lg";const p=(y,m,n,k="")=>{const w=document.createElement("div"),h=document.createElement("label");h.setAttribute("for",m),h.className="block text-sm font-medium mb-1",h.textContent=y,w.appendChild(h);const a=document.createElement("input");return a.setAttribute("type",n),a.setAttribute("id",m),a.setAttribute("name",m),a.className="w-full px-4 py-2 rounded-md bg-gray-700 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",a.value=k,w.appendChild(a),{div:w,input:a}},{div:U,input:v}=p("Username","name","text",d);v.setAttribute("readonly",!0),v.classList.add("bg-gray-600","cursor-not-allowed"),t.appendChild(U);const{div:j,input:L}=p("E-mail","email","email",I);L.setAttribute("readonly",!0),L.classList.add("bg-gray-600","cursor-not-allowed"),t.appendChild(j);const{div:P,input:C}=p("Avatar URL","avatar-url","url",(l==null?void 0:l.url)||"");t.appendChild(P);const{div:B,input:x}=p("Banner URL","banner-url","url",(i==null?void 0:i.url)||"");t.appendChild(B);const E=document.createElement("div"),f=document.createElement("label");f.setAttribute("for","bio"),f.className="block text-sm font-medium mb-1",f.textContent="Bio",E.appendChild(f);const r=document.createElement("textarea");r.id="bio",r.name="bio",r.rows=3,r.className="w-full px-4 py-2 rounded-md bg-gray-700 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",r.textContent=F||"",E.appendChild(r),t.appendChild(E);const c=document.createElement("img");c.src=(l==null?void 0:l.url)||"",c.alt="Avatar Preview",c.className="w-24 h-24 rounded-full object-cover mt-2",P.appendChild(c);const u=document.createElement("img");u.src=(i==null?void 0:i.url)||"",u.alt="Banner Preview",u.className="w-full h-32 object-cover mt-2",B.appendChild(u),C.addEventListener("input",()=>{c.src=C.value}),x.addEventListener("input",()=>{u.src=x.value});const b=document.createElement("button");b.type="submit",b.textContent="Save Changes",b.className="w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 rounded-md text-white font-semibold transition-colors",t.appendChild(b),s.appendChild(t),t.addEventListener("submit",y=>{y.preventDefault();const m={name:v.value,avatar:{url:C.value,alt:"User avatar"},banner:{url:x.value,alt:"Profile banner"},bio:r.value};fetch(`https://v2.api.noroff.dev/auction/profiles/${A}`,{method:"PUT",headers:{Authorization:`Bearer ${N}`,"X-Noroff-API-Key":D,"Content-Type":"application/json"},body:JSON.stringify(m)}).then(n=>n.json()).then(n=>{n.errors?(o.textContent=n.errors[0].message,o.classList.remove("hidden")):(alert("Profile updated successfully!"),window.location.href="/html/profile.html")}).catch(n=>{console.error("Error updating profile:",n),o.textContent="Something went wrong.",o.classList.remove("hidden")})})}).catch(e=>{const d=document.createElement("p");d.textContent="Could not fetch profile data.",d.className="text-red-500 text-center",s.appendChild(d),console.error("Error fetching profile data:",e)});
