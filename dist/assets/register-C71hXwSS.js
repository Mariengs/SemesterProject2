import{t as d,R as f}from"./navbar-CV3-IAa4.js";import{u as g}from"./authHelpers-DyxOVpWD.js";document.addEventListener("DOMContentLoaded",function(){d(),g()});function a(t,e){const r=document.getElementById(t);r&&(r.textContent=e,r.classList.remove("hidden"))}function E(){document.querySelectorAll(".error-message").forEach(t=>{t.classList.add("hidden"),t.textContent=""})}function m(t){try{return new URL(t),!0}catch{return!1}}function h(){var l,u,c;E();const t=document.getElementById("name").value.trim(),e=document.getElementById("email").value.trim(),r=document.getElementById("password").value.trim(),s=((l=document.getElementById("bio"))==null?void 0:l.value.trim())||null,o=((u=document.getElementById("avatar"))==null?void 0:u.value.trim())||null,i=((c=document.getElementById("banner"))==null?void 0:c.value.trim())||null;let n=!0;return t?/[^a-zA-Z0-9_]/.test(t)&&(a("nameError","Username can only contain letters, numbers, and underscores."),n=!1):(a("nameError","Username is required."),n=!1),e?e.endsWith("@stud.noroff.no")||(a("emailError","Email must end with @stud.noroff.no."),n=!1):(a("emailError","Email is required."),n=!1),r?r.length<8&&(a("passwordError","Password must be at least 8 characters."),n=!1):(a("passwordError","Password is required."),n=!1),s&&s.length>160&&(a("bioError","Bio must be less than 160 characters."),n=!1),o&&!m(o)&&(a("avatarError","Avatar must be a valid URL."),n=!1),i&&!m(i)&&(a("bannerError","Banner must be a valid URL."),n=!1),n?{name:t,password:r,email:e,bio:s,avatar:o,banner:i}:null}function v({name:t,email:e,password:r,bio:s,avatar:o,banner:i}){return{name:t,email:e,password:r,bio:s??"Default bio",avatar:{url:o||"https://via.placeholder.com/150",alt:"User avatar"},banner:{url:i||"https://via.placeholder.com/600x200",alt:"User banner"},venueManager:!0}}async function y(t){try{const e=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const s=await e.json();console.error("Something went wrong:",s),a("formError",`Registration failed: ${s.message||e.statusText}`);return}const r=await e.json();localStorage.setItem("accessToken",r.accessToken),alert("Registration successful!"),window.location.href="login.html"}catch(e){a("formError",`Something went wrong: ${e.message}`)}}document.getElementById("registerForm").addEventListener("submit",function(t){t.preventDefault();const e=h();if(!e)return;const r=v(e);y(r)});
